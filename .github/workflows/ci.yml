name: CI/CD Pipeline

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Install Backend Dependencies
      run: npm install
      working-directory: meu-app/backend

    - name: Run Backend Tests
      run: npm test
      working-directory: meu-app/backend
      env:
        # Variáveis de ambiente para o teste de backend (se necessário)
        # Como os testes de unidade do modelo não dependem de conexão real com o DB, não é necessário o MONGO_URI
        # Mas se fossem testes de integração, seria necessário um mock ou um DB de teste.

    - name: Install Frontend Dependencies
      run: npm install
      working-directory: meu-app/frontend

    - name: Run Frontend Tests
      run: npm test
      working-directory: meu-app/frontend

    # A etapa de Deploy Automático é omitida por enquanto, pois o deploy real
    # depende de um serviço de hospedagem (como Render, Vercel, AWS, etc.)
    # e das credenciais do usuário. O foco agora é no CI (Testes).
    # Para fins de demonstração do CI, a execução dos testes é suficiente.
    # Se o usuário fornecer um serviço de deploy, esta etapa será adicionada.
    
    - name: Deploy (Placeholder)
      run: echo "Deploy step would go here if a target environment was provided."
